# 网络

### 1.HTTP协议

###### 1.HTTP+HTTPS

超文本传输协议

 超文本 传输 协议

HTTPS解决安全问题---密文传输

​	混合加密+摘要算法

###### 2.Get Post

安全 不破坏资源

幂等 多次请求结果一致

###### 3.HTTP 1.1 优缺点

 简单 Header+Body

方便 不存信息---无法保存客户信息---Cookies

不安全 明文送信息----HTTPS+JWT

性能 长连接-----只要任意一端没有明确提出断开连接，则保持 TCP 连接状态。

​		 长连接-----导致管道传输可能-----请求一直发，请求对列---之前是事务-事务

长连接新问题：队头阻塞------第一个请求被堵

###### 4.HTTPS 是如何建立连接的？其间交互了什么？

​	1.ClientHello(需要被兼容)

​	版本协议+客户端随机数+用什么加密算法

​	2.ServerHello(兼容客户端)

​	确认协议版本+确认算法

​	产生服务端随机数+提供服务端数字证书

​	3.客户端回应

​	CA公钥确认证书

​	第三随机数+加密算法改变通知（用会话密钥）

​	客户端+服务端-----通过3个随机数各自生成会话秘钥

​	4.服务端最后回应

​	OK的意思

###### 5.HTTP 2 3目的就是优化性能

​	1.1改动

​	长连接+管道运输-----队首阻塞

###### 6.那上面的 HTTP/1.1 的性能瓶颈，HTTP/2 做了什么优化？

​	1.头部压缩

​	相同请求头只发索引表中索引

​	2.发二进制

​	3.数据流

​	4.多路复用---人人都是车头

​	5.服务端主动推送--先发也许会用到的(Cache Push)

###### 7.HTTP/2 有哪些缺陷？HTTP/3 做了哪些优化？

​	HTTP/2 多个请求复用一个TCP连接，一旦发生丢包，就会阻塞住所有的 HTTP 请求.

​	HTTP3 改为 UDP连接



### 2.IP

###### 1.MAC与IP

​	MAC---区间通行

​	IP----起点到终点

###### 2.IP

​	有一点比较核心-----IP4原本是32位二进制的，点分为四组----转换为现在的IP地址

​	IP6 64位 16位分一组

###### 3.网络地址+主机地址

​	32位---ABCDE

​	8 24

​	16 16

​	24 8

###### 4.子网划分

​	将主机地址----划分为子网网络地址+子网主机地址

###### 5.域名解析---DNS解析流程

​	1.浏览器查缓存+操作系统缓存+检查本机域名解析文件

​	2.浏览器请求本地DNS服务器

​	3.DNS服务器返根服务器

​	4.根服务器返域名服务器

###### 6.IP分片与重组

​	最常见数据链路是以太网，它的 MTU 是 1500 字节。

​	那么当 IP 数据包大小大于 MTU 时， IP 数据包就会被分片。

###### 7.自己的理解

​	首先个人用户用的可能是分化后再分化的网络节点

​	传输信号像快递

​	IP---公网IP

​			私网IP+子网主机地址



​	MAC---硬件编号

​	交换机---多个MAC并入其中---区分不同电脑

​					交换机和交换机----通过路由进行通信



​	路由器---区分IP地址---区分公网IP地址----通信不同交换机信号



​	如果公网IP在一个地方----那就是同一局域网，不走路由--直接广播



​	如果公网IP不相同----不同局域网---走路由，传输快递



##### 3.ping 的工作原理

 1.ICMP 是什么？

 	互联网控制报文协议 Internet Control Message Protocol

 2.IP包是什么还记得吗？

 	协议中规定的传输量，如果大于就要分包---1500字节

 3.ICMP 功能都有啥？

​	 确认是否成功送达+报告失败原因+改善设置

​	 怎么发送？

​	 通过IP发送----例子中路由器2---路由器1----主机A

 4.ICMP 包头格式

 	封装在IP包里

​	 IP头+ICMP报文

​	 1.包头类型

​	 查询报文 或者 差错报文

​	 2.查询报文

 	0 8 两种类型

​	 8发送 0接受

 	3.差错报文

​	 3---不可送达

 	4---原点抑制消息

 	5---重定向

 	11---超时消息

5.差错报文中 不可送达-3 的几种分类

​	 0 网络不可达

​	 找不到此IP地址

​	 1 主机不可达

​	 找不到MAC地址

​	 2 协议不可达

 	主机端有可能禁止TCP协议

 	3 端口不可达

​	 具体的程序没有监听

​	 4 设置了不可分片

​	 就是只接受不分包数据 分包就直接舍弃

6.原点抑制消息 4

 	缓和拥堵情况----增大IP包的传输间隔

7.重定向消息 5

​	 主机端的路径不是最优路径----返重定向

 	定向到最短路径

8.超时消息 11

​	 IP 包中有一个字段叫做 TTL （ Time To Live ，生存周期），它的值随着每经过一次路由器就会减 1，直到减到 0 时该 IP 包会被丢弃。

​	 如果TTL==0 返回超时消息 ----此包被抛弃

 	设置过期时间，防止无限转发





9.查询报文类型的使用

​	 比较重点的是Ping流程如何：

​	 1.构建报文本身--Body

​	 ICMP回送请求消息-----类型+序号+时间

​											区分是什么消息+区分ping的时候发出的连续数据包是哪一个

​	2.构建IP头--Header part1

​	源地址---自己的IP---自己所在小区名

​	目标地址---目标的IP---目标所在小区名

​	遵循协议：1---代表ICMP---走哪家快递公司

​	2.构建MAC头---通过IP-mac映射表或者路由通过ARC发包获取

​	源MAC---自己的姓名

​	目标MAC---对方姓名

​	3.传输过程

​	 A传到交换机判断是不是一个子网，子网直接广播---通过IP和子关网络码判断

​	传输到分管路由,传入到分管路由

​	路由到交换机--交换机通过mac到B

​		B看IP与MAC是不是对应，不对应直接舍弃

​	4.返回

​	B接受后传返信------ICMP报文类型设置为0 序号设置为接受时信号

​	A过期时间没有接受返信----判定不通---返不可达

​							接受----返回时间-发出时间--延迟





10.差错报文使用------traceroute 集成应用



11.traceroute 用处1：设置特殊TTL（过期时间），追踪途经路由器---获取路由IP

​	比如指向特定IP地址：192.168.1.100

​	

​	怎么工作？

​	TTL从1递增，相当于每路过一个路由----返一个路由的地址

​	递增---拿到所有的路由IP

​	

​	发送方如何知道发出的 UDP 包是否到达了目的主机呢？

​		利用差错代码机制---采用不可达的机制

​		故意填错收货人-----这样就会知道---货到了

​	traceroute 在发送 UDP 包时，会填入一个不可能的端口号值作为 UDP 目标端口号（大于 3000 ）。当目的主机，收到 UDP 包后，会返回 ICMP 差错报文消息，但这个差错报文消息的类型是「端口 不可达」。 所以，当差错报文类型是端口不可达时，说明发送方发出的 UDP 包到达了目的主机。



12.traceroute 用处2：故意设置不分片----确定路径MTU---确定路径的最大文件大小

​		因为有的时候我们并不知道路由器的 MTU 大小，以太网的数据链路上的 MTU 通常是 1500 字 节，但是非以外网的 MTU 值就不一样了，所以我们要知道 MTU 的大小，从而控制发送的包大小

​		

​		工作原理：

​		每次收到 ICMP 差错报文时就减少包的大小，以此来定位一个合适的 MTU 值，成功抵达目标主机



#### 4.URL的解析过程



​		1.解析URL-----实际上就是找到文件所在的位置 请求它

​		协议+服务器+目录位置

​		http://www.server.com/dir1/file1.html

​		如果没有 目录位置----默认请求的为 index or default

​		2.生成HTTP请求报文----请求头+Body（请求主体）

​		请求头带参数

​		请求主体填信息---基本上用Json来传

​		3.通过Web服务器查出IP地址----DNS服务器



​		DNS服务器保存----IP地址与Web服务器的映射



​		如果属于同一子网，直接过去了

​		不是同一字网，查询服务器的IP地址

​		

​		复习过往知识----域名层级关系？

​		从左往右，越来越大，跟我国相反

​		从大往小找----找到目标IP

​		根DNS---顶级域DNS(com)----权威DNS(server.com)



​		4.具体的域名解析过程

​		

​			1.查浏览器缓存+查本地缓存

​			2.查询本地DNS服务器

​			3.本地DNS直接去最高级别----根域名服务器

​			4.一层一层挨个往下查找

​			5.返IP地址给本地DNS服务器



​	5.从DNS获取IP-------HTTP通过协议栈传输信息

​			

​		

​	

​	

​	

​	
